machine:
  # Version of ruby to use
  ruby:
    version:
      2.4.0

dependencies:
  pre:
    - cd ~
    - git clone https://github.com/rbenv/rbenv.git ~/.rbenv
    - echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bashrc
    - echo 'eval "$(rbenv init -)"' >> ~/.bashrc
    #- exec $SHELL
    - git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
    - echo 'export PATH="$HOME/.rbenv/plugins/ruby-build/bin:$PATH"' >> ~/.bashrc
   # - exec $SHELL
    - rbenv install 2.4.0
    - rbenv global 2.4.0
    - ruby -v
    - sudo apt-get -y update
    - sudo apt-get -y install git-core 
    - gem install capistrano
    - git clone https://github.com/vsirius/capistrano.git
    - gem install bundler

test:
  override:
    - nosetests

deployment:
    commands:
      - cd capistrano
      - bundle install
      - bundle exec cap production deploy
